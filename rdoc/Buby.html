<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Buby - buby 1.3.3</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/buby/extends/buby_array_wrapper.rb
    <li>lib/buby/extends/http_request_response.rb
    <li>lib/buby/extends/scan_issue.rb
    <li>lib/buby.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="Object.html">Object</a>
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-burp_loaded-3F">::burp_loaded?</a>
    
    <li><a href="#method-c-libpath">::libpath</a>
    
    <li><a href="#method-c-load_burp">::load_burp</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-c-path">::path</a>
    
    <li><a href="#method-c-require_all_libs_relative_to">::require_all_libs_relative_to</a>
    
    <li><a href="#method-c-start_burp">::start_burp</a>
    
    <li><a href="#method-i-_check_and_callback">#_check_and_callback</a>
    
    <li><a href="#method-i-_check_cb">#_check_cb</a>
    
    <li><a href="#method-i-activate-21">#activate!</a>
    
    <li><a href="#method-i-active_scan">#active_scan</a>
    
    <li><a href="#method-i-addToSiteMap">#addToSiteMap</a>
    
    <li><a href="#method-i-add_to_site_map">#add_to_site_map</a>
    
    <li><a href="#method-i-alert">#alert</a>
    
    <li><a href="#method-i-burp_callbacks">#burp_callbacks</a>
    
    <li><a href="#method-i-burp_extender">#burp_extender</a>
    
    <li><a href="#method-i-burp_version">#burp_version</a>
    
    <li><a href="#method-i-close">#close</a>
    
    <li><a href="#method-i-config">#config</a>
    
    <li><a href="#method-i-config-3D">#config=</a>
    
    <li><a href="#method-i-doActiveScan">#doActiveScan</a>
    
    <li><a href="#method-i-doPassiveScan">#doPassiveScan</a>
    
    <li><a href="#method-i-do_active_scan">#do_active_scan</a>
    
    <li><a href="#method-i-do_passive_scan">#do_passive_scan</a>
    
    <li><a href="#method-i-evt_application_closing">#evt_application_closing</a>
    
    <li><a href="#method-i-evt_command_line_args">#evt_command_line_args</a>
    
    <li><a href="#method-i-evt_extender_init">#evt_extender_init</a>
    
    <li><a href="#method-i-evt_http_message">#evt_http_message</a>
    
    <li><a href="#method-i-evt_proxy_message">#evt_proxy_message</a>
    
    <li><a href="#method-i-evt_proxy_message_raw">#evt_proxy_message_raw</a>
    
    <li><a href="#method-i-evt_register_callbacks">#evt_register_callbacks</a>
    
    <li><a href="#method-i-evt_scan_issue">#evt_scan_issue</a>
    
    <li><a href="#method-i-excludeFromScope">#excludeFromScope</a>
    
    <li><a href="#method-i-exclude_from_scope">#exclude_from_scope</a>
    
    <li><a href="#method-i-exclude_scope">#exclude_scope</a>
    
    <li><a href="#method-i-exitSuite">#exitSuite</a>
    
    <li><a href="#method-i-exit_suite">#exit_suite</a>
    
    <li><a href="#method-i-getBurpVersion">#getBurpVersion</a>
    
    <li><a href="#method-i-getHeaders">#getHeaders</a>
    
    <li><a href="#method-i-getParameters">#getParameters</a>
    
    <li><a href="#method-i-getProxyHistory">#getProxyHistory</a>
    
    <li><a href="#method-i-getScanIssues">#getScanIssues</a>
    
    <li><a href="#method-i-getSiteMap">#getSiteMap</a>
    
    <li><a href="#method-i-get_headers">#get_headers</a>
    
    <li><a href="#method-i-get_parameters">#get_parameters</a>
    
    <li><a href="#method-i-get_proxy_history">#get_proxy_history</a>
    
    <li><a href="#method-i-get_scan_issues">#get_scan_issues</a>
    
    <li><a href="#method-i-get_site_map">#get_site_map</a>
    
    <li><a href="#method-i-harvest_cookies_from_history">#harvest_cookies_from_history</a>
    
    <li><a href="#method-i-headers">#headers</a>
    
    <li><a href="#method-i-in_scope-3F">#in_scope?</a>
    
    <li><a href="#method-i-includeInScope">#includeInScope</a>
    
    <li><a href="#method-i-include_in_scope">#include_in_scope</a>
    
    <li><a href="#method-i-include_scope">#include_scope</a>
    
    <li><a href="#method-i-intruder">#intruder</a>
    
    <li><a href="#method-i-isInScope">#isInScope</a>
    
    <li><a href="#method-i-is_in_scope">#is_in_scope</a>
    
    <li><a href="#method-i-issueAlert">#issueAlert</a>
    
    <li><a href="#method-i-issue_alert">#issue_alert</a>
    
    <li><a href="#method-i-loadConfig">#loadConfig</a>
    
    <li><a href="#method-i-load_config">#load_config</a>
    
    <li><a href="#method-i-makeHttpRequest">#makeHttpRequest</a>
    
    <li><a href="#method-i-make_http_request">#make_http_request</a>
    
    <li><a href="#method-i-make_request">#make_request</a>
    
    <li><a href="#method-i-parameters">#parameters</a>
    
    <li><a href="#method-i-passive_scan">#passive_scan</a>
    
    <li><a href="#method-i-proxy_history">#proxy_history</a>
    
    <li><a href="#method-i-proxy_interception-3D">#proxy_interception=</a>
    
    <li><a href="#method-i-proxy_interception_enabled">#proxy_interception_enabled</a>
    
    <li><a href="#method-i-registerMenuItem">#registerMenuItem</a>
    
    <li><a href="#method-i-register_menu_item">#register_menu_item</a>
    
    <li><a href="#method-i-repeater">#repeater</a>
    
    <li><a href="#method-i-restoreState">#restoreState</a>
    
    <li><a href="#method-i-restore_state">#restore_state</a>
    
    <li><a href="#method-i-saveConfig">#saveConfig</a>
    
    <li><a href="#method-i-saveState">#saveState</a>
    
    <li><a href="#method-i-save_config">#save_config</a>
    
    <li><a href="#method-i-save_state">#save_state</a>
    
    <li><a href="#method-i-scan_issues">#scan_issues</a>
    
    <li><a href="#method-i-search_proxy_history">#search_proxy_history</a>
    
    <li><a href="#method-i-sendToIntruder">#sendToIntruder</a>
    
    <li><a href="#method-i-sendToRepeater">#sendToRepeater</a>
    
    <li><a href="#method-i-sendToSpider">#sendToSpider</a>
    
    <li><a href="#method-i-send_to_intruder">#send_to_intruder</a>
    
    <li><a href="#method-i-send_to_repeater">#send_to_repeater</a>
    
    <li><a href="#method-i-send_to_spider">#send_to_spider</a>
    
    <li><a href="#method-i-setProxyInterceptionEnabled">#setProxyInterceptionEnabled</a>
    
    <li><a href="#method-i-site_map">#site_map</a>
    
    <li><a href="#method-i-spider">#spider</a>
    
    <li><a href="#method-i-start_burp">#start_burp</a>
    
    <li><a href="#method-i-with_proxy_history">#with_proxy_history</a>
    
    <li><a href="#method-i-with_site_map">#with_site_map</a>
    
    <li><a href="#method-i-with_statefile">#with_statefile</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./History_txt.html">History</a>
  
    <li class="file"><a href="./README_rdoc.html">README</a>
  
    <li class="file"><a href="./bin/buby.html">buby</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Buby.html">Buby</a>
  
    <li><a href="./Buby/BubyArrayWrapper.html">Buby::BubyArrayWrapper</a>
  
    <li><a href="./Buby/HttpRequestResponseHelper.html">Buby::HttpRequestResponseHelper</a>
  
    <li><a href="./Buby/HttpRequestResponseList.html">Buby::HttpRequestResponseList</a>
  
    <li><a href="./Buby/ScanIssueHelper.html">Buby::ScanIssueHelper</a>
  
    <li><a href="./Buby/ScanIssuesList.html">Buby::ScanIssuesList</a>
  
    <li><a href="./Object.html">Object</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Buby</h1>

  <div id="description" class="description">
    
<p><a href="Buby.html">Buby</a> is a mash-up of the commercial security
testing web proxy PortSwigger  Burp Suite(tm) allowing you to add scripting
to Burp. Burp is driven from  and tied to JRuby with a Java extension using
the BurpExtender API.</p>

<p>The <a href="Buby.html">Buby</a> class is an abstract implementation of a
BurpExtender ruby handler.  Included are several abstract event handlers
used from the BurpExtender java implementation:</p>
<ul><li>
<p><a href="Buby.html#method-i-evt_extender_init">#evt_extender_init</a></p>
</li><li>
<p><a href="Buby.html#method-i-evt_proxy_message">#evt_proxy_message</a></p>
</li><li>
<p><a
href="Buby.html#method-i-evt_command_line_args">#evt_command_line_args</a></p>
</li><li>
<p><a
href="Buby.html#method-i-evt_register_callbacks">#evt_register_callbacks</a></p>
</li><li>
<p><a
href="Buby.html#method-i-evt_application_closing">#evt_application_closing</a></p>
</li></ul>

<p><a href="Buby.html">Buby</a> also supports the newer event handlers
available in Burp 1.2.09 and up:</p>
<ul><li>
<p><a href="Buby.html#method-i-evt_http_message">#evt_http_message</a></p>
</li><li>
<p><a href="Buby.html#method-i-evt_scan_issue">#evt_scan_issue</a></p>
</li></ul>

<p>This class also exposes several methods to access Burp functionality  and
user interfaces through the IBurpExtenderCallbacks interface  (note,
several abbreviated aliases also exist for each):</p>
<ul><li>
<p>doActiveScan</p>
</li><li>
<p>doPassiveScan</p>
</li><li>
<p>excludeFromScope</p>
</li><li>
<p>includeInScope</p>
</li><li>
<p>isInScope</p>
</li><li>
<p>issueAlert</p>
</li><li>
<p>makeHttpRequest</p>
</li><li>
<p>sendToIntruder</p>
</li><li>
<p>sendToRepeater</p>
</li><li>
<p>sendToSpider</p>
</li></ul>

<p><a href="Buby.html">Buby</a> also provides front-end ruby methods for the
various callback methods  supported by Burp. New callbacks have been
cropping up in newer Burp versions frequently.</p>

<p>Available since Burp 1.2.09:</p>
<ul><li>
<p>getProxyHistory</p>
</li><li>
<p>getSiteMap</p>
</li><li>
<p>restoreState</p>
</li><li>
<p>saveState</p>
</li><li>
<p>getParameters</p>
</li><li>
<p>getHeaders</p>
</li></ul>

<p>Available since Burp 1.2.15:</p>
<ul><li>
<p>getScanIssues</p>
</li></ul>

<p>Available since Burp 1.2.17:</p>
<ul><li>
<p>exitSuite</p>
</li></ul>

<p>If you wish to access any of the IBurpExtenderCallbacks methods directly. 
You can use ‘<a
href="Buby.html#method-i-burp_callbacks">#burp_callbacks</a>’ to obtain a
reference.</p>

<p>Credit:</p>
<ul><li>
<p>Burp and Burp Suite are trade-marks of PortSwigger Ltd.</p>

<pre>Copyright 2011 PortSwigger Ltd. All rights reserved.
See http://portswigger.net for license terms.</pre>
</li><li>
<p>This ruby library and the accompanying BurpExtender.java implementation 
were written by Eric Monti @ Matasano Security.</p>

<p>Matasano claims no professional or legal affiliation with PortSwigger LTD. 
nor do we sell or officially endorse any of their products.</p>

<p>However, this author would like to express his personal and professional 
respect and appreciation for their making available the BurpExtender 
extension API. The availability of this interface in an already great tool
goes a long way to make Burp Suite a truly first-class application.</p>
</li><li>
<p>Forgive the name. It won out over “Burb” and “BurpRub”. It’s just easier 
to type and say out-loud. Mike Tracy gets full credit as official 
Buby-namer.</p>
</li></ul>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="ACTION_DONT_INTERCEPT">ACTION_DONT_INTERCEPT
        
        <dd class="description">
        
      
        <dt id="ACTION_DONT_INTERCEPT_AND_REHOOK">ACTION_DONT_INTERCEPT_AND_REHOOK
        
        <dd class="description">
        
      
        <dt id="ACTION_DO_INTERCEPT">ACTION_DO_INTERCEPT
        
        <dd class="description">
        
      
        <dt id="ACTION_DO_INTERCEPT_AND_REHOOK">ACTION_DO_INTERCEPT_AND_REHOOK
        
        <dd class="description">
        
      
        <dt id="ACTION_DROP">ACTION_DROP
        
        <dd class="description">
        
      
        <dt id="ACTION_FOLLOW_RULES">ACTION_FOLLOW_RULES
        
        <dd class="description">
        
      
        <dt id="ACTION_FOLLOW_RULES_AND_REHOOK">ACTION_FOLLOW_RULES_AND_REHOOK
        
        <dd class="description">
        
      
        <dt id="VERSION">VERSION
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-burp_loaded-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">burp_loaded?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Checks the Java namespace to see if Burp has been loaded.</p>
          

          
          <div class="method-source-code" id="burp_loaded-3F-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 831</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">burp_loaded?</span>
  <span class="ruby-ivar">@burp_loaded</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">java_import</span> <span class="ruby-string">'burp.StartBurp'</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- burp_loaded-3F-source -->
          
        </div>

        

        
      </div><!-- burp_loaded-3F-method -->

    
      <div id="method-c-libpath" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">libpath</span><span
            class="method-args">( *args )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the library path for the module. If any arguments are given, they
will be joined to the end of the libray path using <code>File.join</code>.</p>
          

          
          <div class="method-source-code" id="libpath-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 846</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">libpath</span>( *<span class="ruby-identifier">args</span> )
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-constant">LIBPATH</span> <span class="ruby-operator">:</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">LIBPATH</span>, <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- libpath-source -->
          
        </div>

        

        
      </div><!-- libpath-method -->

    
      <div id="method-c-load_burp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_burp</span><span
            class="method-args">(jar_path)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Attempts to load burp with require and confirm it provides the required 
class in the Java namespace.</p>

<p>Returns: true/false depending on whether the required jar provides us the
required class</p>

<p>Raises: may raise the usual require exceptions if jar_path is bad.</p>
          

          
          <div class="method-source-code" id="load_burp-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 825</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">load_burp</span>(<span class="ruby-identifier">jar_path</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-identifier">jar_path</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">burp_loaded?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- load_burp-source -->
          
        </div>

        

        
      </div><!-- load_burp-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(other=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">other</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">other</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;arg 0 must be another kind of Buby&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Buby</span>
    <span class="ruby-ivar">@burp_extender</span> = <span class="ruby-identifier">other</span>.<span class="ruby-identifier">burp_extender</span>
    <span class="ruby-ivar">@burp_callbacks</span> = <span class="ruby-identifier">other</span>.<span class="ruby-identifier">burp_callbacks</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">path</span><span
            class="method-args">( *args )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the lpath for the module. If any arguments are given, they will be
joined to the end of the path using <code>File.join</code>.</p>
          

          
          <div class="method-source-code" id="path-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 854</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>( *<span class="ruby-identifier">args</span> )
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-constant">PATH</span> <span class="ruby-operator">:</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">PATH</span>, <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- path-source -->
          
        </div>

        

        
      </div><!-- path-method -->

    
      <div id="method-c-require_all_libs_relative_to" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">require_all_libs_relative_to</span><span
            class="method-args">( fname, dir = nil )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Utility method used to require all files ending in .rb that lie in the
directory below this file that has the same name as the filename passed in.
Optionally, a specific <em>directory</em> name can be passed in such that
the <em>filename</em> does not have to be equivalent to the directory.</p>
          

          
          <div class="method-source-code" id="require_all_libs_relative_to-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 863</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">require_all_libs_relative_to</span>( <span class="ruby-identifier">fname</span>, <span class="ruby-identifier">dir</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">dir</span> <span class="ruby-operator">||=</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">fname</span>, <span class="ruby-string">'.*'</span>)
  <span class="ruby-identifier">search_me</span> = <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(
      <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">fname</span>), <span class="ruby-identifier">dir</span>, <span class="ruby-string">'**'</span>, <span class="ruby-string">'*.rb'</span>))

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">search_me</span>).<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">rb</span><span class="ruby-operator">|</span> <span class="ruby-identifier">require</span> <span class="ruby-identifier">rb</span>}
<span class="ruby-keyword">end</span></pre>
          </div><!-- require_all_libs_relative_to-source -->
          
        </div>

        

        
      </div><!-- require_all_libs_relative_to-method -->

    
      <div id="method-c-start_burp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start_burp</span><span
            class="method-args">(h_class=nil, init_args=nil, args=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Starts burp using a supplied handler class,</p>

<pre class="ruby"><span class="ruby-identifier">h_class</span> = <span class="ruby-constant">Buby</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">derived</span> <span class="ruby-keyword">class</span>. <span class="ruby-identifier">instance</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">which</span> <span class="ruby-identifier">will</span> <span class="ruby-identifier">become</span> <span class="ruby-identifier">handler</span>.
<span class="ruby-identifier">args</span> = <span class="ruby-identifier">arguments</span> <span class="ruby-identifier">to</span> <span class="ruby-constant">Burp</span>
<span class="ruby-identifier">init_args</span> = <span class="ruby-identifier">arguments</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">handler</span> <span class="ruby-identifier">constructor</span>

<span class="ruby-constant">Returns</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">handler</span> <span class="ruby-identifier">instance</span>
</pre>
          

          
          <div class="method-source-code" id="start_burp-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 811</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">start_burp</span>(<span class="ruby-identifier">h_class</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">init_args</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">args</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">h_class</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">init_args</span> <span class="ruby-operator">||=</span> []
  <span class="ruby-identifier">args</span> <span class="ruby-operator">||=</span> []
  <span class="ruby-identifier">h_class</span>.<span class="ruby-identifier">new</span>(*<span class="ruby-identifier">init_args</span>).<span class="ruby-identifier">start_burp</span>(<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- start_burp-source -->
          
        </div>

        

        
      </div><!-- start_burp-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-_check_and_callback" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_check_and_callback</span><span
            class="method-args">(meth, *args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is a __send__ callback gate for the IBurpExtenderCallbacks
reference. It first checks to see if a method is available before calling
with the specified arguments, and raises an exception if it is unavailable.</p>
<ul><li>
<p>meth = string or symbol name of method</p>
</li><li>
<p>args = variable length array of arguments to pass to meth</p>
</li></ul>
          

          
          <div class="method-source-code" id="_check_and_callback-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-identifier">meth</span>, *<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">cb</span> = <span class="ruby-identifier">_check_cb</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;#{meth} is not available in your version of Burp&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">__send__</span> <span class="ruby-identifier">meth</span>, *<span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- _check_and_callback-source -->
          
        </div>

        

        
      </div><!-- _check_and_callback-method -->

    
      <div id="method-i-_check_cb" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_check_cb</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Internal method to check for the existence of the <a
href="Buby.html#method-i-burp_callbacks">#burp_callbacks</a> reference
before doing anything with it.</p>
          

          
          <div class="method-source-code" id="_check_cb-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_check_cb</span>
  <span class="ruby-ivar">@burp_callbacks</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Burp callbacks have not been set&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- _check_cb-source -->
          
        </div>

        

        
      </div><!-- _check_cb-method -->

    
      <div id="method-i-activate-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">activate!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Makes this handler the active Ruby handler object for the BurpExtender Java
runtime. (there can be only one!)</p>
          

          
          <div class="method-source-code" id="activate-21-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">activate!</span>
  <span class="ruby-constant">BurpExtender</span>.<span class="ruby-identifier">set_handler</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- activate-21-source -->
          
        </div>

        

        
      </div><!-- activate-21-method -->

    
      <div id="method-i-active_scan" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">active_scan</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-doActiveScan">doActiveScan</a>
        </div>
        
      </div><!-- active_scan-method -->

    
      <div id="method-i-addToSiteMap" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addToSiteMap</span><span
            class="method-args">(item)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method can be used to add an item to Burp’s site map with the
specified request/response details. This will overwrite the details of any
existing matching item in the site map.</p>

<p>@param item Details of the item to be added to the site map</p>

<p>This method is only available with Burp 1.3.09+</p>
          

          
          <div class="method-source-code" id="addToSiteMap-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 380</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addToSiteMap</span>(<span class="ruby-identifier">item</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:addToSiteMap</span>, <span class="ruby-identifier">item</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- addToSiteMap-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-add_to_site_map">add_to_site_map</a>
        </div>
        

        
      </div><!-- addToSiteMap-method -->

    
      <div id="method-i-add_to_site_map" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">add_to_site_map</span><span
            class="method-args">(item)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-addToSiteMap">addToSiteMap</a>
        </div>
        
      </div><!-- add_to_site_map-method -->

    
      <div id="method-i-alert" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">alert</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-issueAlert">issueAlert</a>
        </div>
        
      </div><!-- alert-method -->

    
      <div id="method-i-burp_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">burp_callbacks</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the internal reference to the IBupExtenderCallbacks instance. This
reference gets set from Java through the <a
href="Buby.html#method-i-evt_register_callbacks">#evt_register_callbacks</a>
method. It is exposed to allow you to access the IBurpExtenderCallbacks 
instance directly if you so choose.</p>
          

          
          <div class="method-source-code" id="burp_callbacks-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">burp_callbacks</span>; <span class="ruby-ivar">@burp_callbacks</span>; <span class="ruby-keyword">end</span></pre>
          </div><!-- burp_callbacks-source -->
          
        </div>

        

        
      </div><!-- burp_callbacks-method -->

    
      <div id="method-i-burp_extender" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">burp_extender</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the internal reference to the BurpExtender instance. This reference
gets set from Java through the <a
href="Buby.html#method-i-evt_extender_init">#evt_extender_init</a> method.</p>
          

          
          <div class="method-source-code" id="burp_extender-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">burp_extender</span>; <span class="ruby-ivar">@burp_extender</span>; <span class="ruby-keyword">end</span></pre>
          </div><!-- burp_extender-source -->
          
        </div>

        

        
      </div><!-- burp_extender-method -->

    
      <div id="method-i-burp_version" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">burp_version</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getBurpVersion">getBurpVersion</a>
        </div>
        
      </div><!-- burp_version-method -->

    
      <div id="method-i-close" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">close</span><span
            class="method-args">(prompt_user=false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-exitSuite">exitSuite</a>
        </div>
        
      </div><!-- close-method -->

    
      <div id="method-i-config" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">config</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-saveConfig">saveConfig</a>
        </div>
        
      </div><!-- config-method -->

    
      <div id="method-i-config-3D" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">config=</span><span
            class="method-args">(conf)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-loadConfig">loadConfig</a>
        </div>
        
      </div><!-- config-3D-method -->

    
      <div id="method-i-doActiveScan" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">doActiveScan</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Send an HTTP request to the Burp Scanner tool to perform an active 
vulnerability scan.</p>

<pre>* host = The hostname of the remote HTTP server.
* port = The port of the remote HTTP server.
* https = Flags whether the protocol is HTTPS or HTTP.
* req  = The full HTTP request. (String or Java bytes[])
* ip_off = A list of index pairs representing the
* positions of the insertion points that should be scanned. Each item in
* the list must be an int[2] array containing the start and end offsets
* for the insertion point. *1.4+* only</pre>
          

          
          <div class="method-source-code" id="doActiveScan-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">doActiveScan</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">ip_off</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">getBurpVersion</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">doActiveScan</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">ip_off</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">doActiveScan</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- doActiveScan-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-do_active_scan">do_active_scan</a>, <a href="Buby.html#method-i-active_scan">active_scan</a>
        </div>
        

        
      </div><!-- doActiveScan-method -->

    
      <div id="method-i-doPassiveScan" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">doPassiveScan</span><span
            class="method-args">(host, port, https, req, rsp)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Send an HTTP request and response to the Burp Scanner tool to perform a 
passive vulnerability scan.</p>

<pre>* host = The hostname of the remote HTTP server.
* port = The port of the remote HTTP server.
* https = Flags whether the protocol is HTTPS or HTTP.
* req  = The full HTTP request. (String or Java bytes[])
* rsp  = The full HTTP response. (String or Java bytes[])</pre>
          

          
          <div class="method-source-code" id="doPassiveScan-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">doPassiveScan</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">rsp</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">rsp</span> = <span class="ruby-identifier">rsp</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">rsp</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">doPassiveScan</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">rsp</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- doPassiveScan-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-do_passive_scan">do_passive_scan</a>, <a href="Buby.html#method-i-passive_scan">passive_scan</a>
        </div>
        

        
      </div><!-- doPassiveScan-method -->

    
      <div id="method-i-do_active_scan" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">do_active_scan</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-doActiveScan">doActiveScan</a>
        </div>
        
      </div><!-- do_active_scan-method -->

    
      <div id="method-i-do_passive_scan" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">do_passive_scan</span><span
            class="method-args">(host, port, https, req, rsp)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-doPassiveScan">doPassiveScan</a>
        </div>
        
      </div><!-- do_passive_scan-method -->

    
      <div id="method-i-evt_application_closing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_application_closing</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is called by BurpExtender right before closing the application.
Implementations can use this method to perform cleanup tasks such as
closing files or databases before exit.</p>
          

          
          <div class="method-source-code" id="evt_application_closing-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 695</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_application_closing</span> 
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_app_close</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_application_closing-source -->
          
        </div>

        

        
      </div><!-- evt_application_closing-method -->

    
      <div id="method-i-evt_command_line_args" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_command_line_args</span><span
            class="method-args">(args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is called by the BurpExtender implementation Burp startup. The
args parameter contains main()‘s argv command-line arguments array.</p>

<p>Note: This maps to the ‘setCommandLineArgs’ method in the java 
implementation of BurpExtender.</p>

<p>The return value is ignored.</p>
          

          
          <div class="method-source-code" id="evt_command_line_args-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 461</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_command_line_args</span> <span class="ruby-identifier">args</span>
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_args</span>, <span class="ruby-identifier">args</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_command_line_args-source -->
          
        </div>

        

        
      </div><!-- evt_command_line_args-method -->

    
      <div id="method-i-evt_extender_init" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_extender_init</span><span
            class="method-args">(ext)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is called by the BurpExtender java implementation upon 
initialization of the BurpExtender instance for Burp. The args parameter is
passed with a instance of the newly initialized BurpExtender instance  so
that implementations can access and extend its public interfaces.</p>

<p>The return value is ignored.</p>
          

          
          <div class="method-source-code" id="evt_extender_init-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 449</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_extender_init</span> <span class="ruby-identifier">ext</span>
  <span class="ruby-ivar">@burp_extender</span> = <span class="ruby-identifier">ext</span>
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_extender</span>, <span class="ruby-identifier">ext</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_extender_init-source -->
          
        </div>

        

        
      </div><!-- evt_extender_init-method -->

    
      <div id="method-i-evt_http_message" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_http_message</span><span
            class="method-args">(tool_name, is_request, message_info)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is invoked whenever any of Burp’s tools makes an HTTP request 
or receives a response. This is effectively a generalised version of the 
pre-existing <a
href="Buby.html#method-i-evt_proxy_message">#evt_proxy_message</a> method,
and can be used to intercept and  modify the HTTP traffic of all Burp
tools.</p>

<p>IMPORTANT: This event handler is only used in Burp version 1.2.09 and 
higher.</p>

<p>Note: this method maps to the processHttpMessage BurpExtender Java method.</p>

<p>This method should be overridden if you wish to implement functionality
relating to generalized requests and responses from any BurpSuite tool.</p>

<p>You may want to use <a
href="Buby.html#method-i-evt_proxy_message">#evt_proxy_message</a> if you
only intend to work on proxied messages. Note, however, the
IHttpRequestResponse Java object is  not used in <a
href="Buby.html#method-i-evt_proxy_message">#evt_proxy_message</a> and
gives <a href="Buby.html#method-i-evt_http_message">#evt_http_message</a> a
somewhat  nicer interface to work with.</p>

<p>Parameters:</p>
<ul><li>
<p>tool_name = a string name of the tool that generated the message</p>
</li><li>
<p>is_request = boolean true = request / false = response</p>
</li><li>
<p>message_info = an instance of the IHttpRequestResponse Java class with
methods for accessing and manipulating various attributes of the message.</p>
</li></ul>
          

          
          <div class="method-source-code" id="evt_http_message-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 670</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_http_message</span>(<span class="ruby-identifier">tool_name</span>, <span class="ruby-identifier">is_request</span>, <span class="ruby-identifier">message_info</span>)
  <span class="ruby-constant">HttpRequestResponseHelper</span>.<span class="ruby-identifier">implant</span>(<span class="ruby-identifier">message_info</span>)
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_http_message</span>, <span class="ruby-identifier">tool_name</span>, <span class="ruby-identifier">is_request</span>, <span class="ruby-identifier">message_info</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_http_message-source -->
          
        </div>

        

        
      </div><!-- evt_http_message-method -->

    
      <div id="method-i-evt_proxy_message" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_proxy_message</span><span
            class="method-args">(msg_ref, is_req, rhost, rport, is_https, http_meth, url, resourceType, status, req_content_type, message, action)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is called by BurpExtender while proxying HTTP messages and
before passing them through the Burp proxy. Implementations can use this
method to implement arbitrary processing upon HTTP requests and responses 
such as interception, logging, modification, and so on.</p>

<p>The ‘is_req’ parameter indicates whether it is a response or request.</p>

<p>Note: This method maps to the ‘processProxyMessage’ method in the java 
implementation of BurpExtender.</p>

<p>See also, <a
href="Buby.html#method-i-evt_proxy_message_raw">#evt_proxy_message_raw</a>
which is actually called before this in the BurpExtender
processProxyMessage handler.</p>

<p>Below are the parameters descriptions based on the IBurpExtender  javadoc.
Where applicable, decriptions have been modified for  local parameter
naming and other ruby-specific details added.</p>
<ul><li>
<p>msg_ref: An identifier which is unique to a single request/response pair.
This  can be used to correlate details of requests and responses and
perform  processing on the response message accordingly. This number also 
corresponds to the Burp UI’s proxy “history” # column.</p>
</li><li>
<p>is_req: (true/false) Flags whether the message is a client request or a
server response.</p>
</li><li>
<p>rhost: The hostname of the remote HTTP server.</p>
</li><li>
<p>rport: The port of the remote HTTP server.</p>
</li><li>
<p>is_https: Flags whether the protocol is HTTPS or HTTP.</p>
</li><li>
<p>http_meth: The method verb used in the client request.</p>
</li><li>
<p>url: The requested URL. Set in both the request and response.</p>
</li><li>
<p>resourceType: The filetype of the requested resource, or nil if the
resource has no  filetype.</p>
</li><li>
<p>status: The HTTP status code returned by the server. This value is nil for 
request messages.</p>
</li><li>
<p>req_content_type: The content-type string returned by the server. This
value is nil for  request messages.</p>
</li><li>
<p>message: The full HTTP message.</p>

<p>**Ruby note:</p>

<pre>For convenience, the message is received and returned as a ruby 
String object. Internally within Burp it is handled as a java byte[] 
array. See also the notes about the return object below.</pre>
</li><li>
<p>action: An array containing a single integer, allowing the implementation
to  communicate back to Burp Proxy a non-default interception action for 
the message. The default value is <a
href="Buby.html#ACTION_FOLLOW_RULES">ACTION_FOLLOW_RULES</a> (or 0). 
Possible values include:</p>

<pre>ACTION_FOLLOW_RULES = 0
ACTION_DO_INTERCEPT = 1
ACTION_DONT_INTERCEPT = 2
ACTION_DROP = 3</pre>

<p>Refer to the BurpExtender.java source comments for more details.</p>
</li></ul>

<p>Return Value:</p>

<pre>Implementations should return either (a) the same object received
in the message paramater, or (b) a different object containing a 
modified message.</pre>

<p>**IMPORTANT RUBY NOTE: Always be sure to return a new object if making
modifications to messages.</p>

<p>Explanation:  The (a) and (b) convention above is followed rather literally
during type  conversion on the return value back into the java
BurpExtender.</p>

<p>When determining whether a change has been made in the message or not,  the
decision is made based on whether the object returned is the same as the
object submitted in the call to evt_proxy_message.</p>

<p>So, for example, using in-place modification of the message using range 
substring assignments or destructive method variations like String.sub!() 
and String.gsub! alone won’t work because the same object gets returned  to
BurpExtender.</p>

<p>In short, this means that if you want modifications to be made, be sure to
return a different String than the one you got in your handler.</p>

<p>So for example this code won’t do anything at all:</p>

<pre>...
message.sub!(/^GET /, &quot;HEAD &quot;)
return message</pre>

<p>Nor this:</p>

<pre>message[0..4] = &quot;HEAD &quot;
return message</pre>

<p>But this will</p>

<pre>...
return message.sub(/^GET /, &quot;HEAD &quot;)</pre>

<p>And so will this</p>

<pre>...
message[0..4] = &quot;HEAD &quot;
return message.dup</pre>
          

          
          <div class="method-source-code" id="evt_proxy_message-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 625</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_proxy_message</span> <span class="ruby-identifier">msg_ref</span>, <span class="ruby-identifier">is_req</span>, <span class="ruby-identifier">rhost</span>, <span class="ruby-identifier">rport</span>, <span class="ruby-identifier">is_https</span>, <span class="ruby-identifier">http_meth</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">resourceType</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">req_content_type</span>, <span class="ruby-identifier">message</span>, <span class="ruby-identifier">action</span>
  <span class="ruby-identifier">pp</span>([ (<span class="ruby-identifier">is_req</span>)<span class="ruby-operator">?</span> <span class="ruby-value">:got_proxy_request</span> <span class="ruby-operator">:</span> <span class="ruby-value">:got_proxy_response</span>,
       [<span class="ruby-value">:msg_ref</span>, <span class="ruby-identifier">msg_ref</span>], 
       [<span class="ruby-value">:is_req</span>, <span class="ruby-identifier">is_req</span>], 
       [<span class="ruby-value">:rhost</span>, <span class="ruby-identifier">rhost</span>], 
       [<span class="ruby-value">:rport</span>, <span class="ruby-identifier">rport</span>], 
       [<span class="ruby-value">:is_https</span>, <span class="ruby-identifier">is_https</span>], 
       [<span class="ruby-value">:http_meth</span>, <span class="ruby-identifier">http_meth</span>], 
       [<span class="ruby-value">:url</span>, <span class="ruby-identifier">url</span>], 
       [<span class="ruby-value">:resourceType</span>, <span class="ruby-identifier">resourceType</span>], 
       [<span class="ruby-value">:status</span>, <span class="ruby-identifier">status</span>], 
       [<span class="ruby-value">:req_content_type</span>, <span class="ruby-identifier">req_content_type</span>], 
       [<span class="ruby-value">:message</span>, <span class="ruby-identifier">message</span>], 
       [<span class="ruby-value">:action</span>, <span class="ruby-identifier">action</span>[<span class="ruby-value">0</span>]] ]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
  
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_proxy_message-source -->
          
        </div>

        

        
      </div><!-- evt_proxy_message-method -->

    
      <div id="method-i-evt_proxy_message_raw" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_proxy_message_raw</span><span
            class="method-args">(msg_ref, is_req, rhost, rport, is_https, http_meth, url, resourceType, status, req_content_type, message, action)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Seems we need to specifically render our ‘message’ to a string here in
ruby. Otherwise there’s flakiness when converting certain binary non-ascii
sequences. As long as we do it here, it should be fine.</p>

<p>Note: This method maps to the ‘processProxyMessage’ method in the java 
implementation of BurpExtender.</p>

<p>This method just handles the conversion to and from <a
href="Buby.html#method-i-evt_proxy_message">#evt_proxy_message</a> which
expects a message string</p>
          

          
          <div class="method-source-code" id="evt_proxy_message_raw-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 495</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_proxy_message_raw</span> <span class="ruby-identifier">msg_ref</span>, <span class="ruby-identifier">is_req</span>, <span class="ruby-identifier">rhost</span>, <span class="ruby-identifier">rport</span>, <span class="ruby-identifier">is_https</span>, <span class="ruby-identifier">http_meth</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">resourceType</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">req_content_type</span>, <span class="ruby-identifier">message</span>, <span class="ruby-identifier">action</span>
  <span class="ruby-identifier">pp</span> [<span class="ruby-value">:evt_proxy_message_raw_hit</span>, <span class="ruby-identifier">msg_ref</span>, <span class="ruby-identifier">is_req</span>, <span class="ruby-identifier">rhost</span>, <span class="ruby-identifier">rport</span>, <span class="ruby-identifier">is_https</span>, <span class="ruby-identifier">http_meth</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">resourceType</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">req_content_type</span>, <span class="ruby-identifier">message</span>, <span class="ruby-identifier">action</span> ] <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>

  <span class="ruby-identifier">str_msg</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">from_java_bytes</span>(<span class="ruby-identifier">message</span>)
  <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">evt_proxy_message</span>(<span class="ruby-identifier">msg_ref</span>, <span class="ruby-identifier">is_req</span>, <span class="ruby-identifier">rhost</span>, <span class="ruby-identifier">rport</span>, <span class="ruby-identifier">is_https</span>, <span class="ruby-identifier">http_meth</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">resourceType</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">req_content_type</span>, <span class="ruby-identifier">str_msg</span>, <span class="ruby-identifier">action</span>)

  <span class="ruby-identifier">message</span> = <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">object_id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">str_msg</span>.<span class="ruby-identifier">object_id</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_proxy_message_raw-source -->
          
        </div>

        

        
      </div><!-- evt_proxy_message_raw-method -->

    
      <div id="method-i-evt_register_callbacks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_register_callbacks</span><span
            class="method-args">(cb)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is called by BurpExtender on startup to register Burp’s 
IBurpExtenderCallbacks interface object.</p>

<p>This maps to the ‘registerExtenderCallbacks’ method in the Java 
implementation of BurpExtender.</p>

<p>The return value is ignored.</p>
          

          
          <div class="method-source-code" id="evt_register_callbacks-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 472</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_register_callbacks</span> <span class="ruby-identifier">cb</span>
  <span class="ruby-ivar">@burp_callbacks</span> = <span class="ruby-identifier">cb</span>
  <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">issueAlert</span>(<span class="ruby-node">&quot;[JRuby::#{self.class}] registered callback&quot;</span>)
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_callbacks</span>, <span class="ruby-identifier">cb</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_register_callbacks-source -->
          
        </div>

        

        
      </div><!-- evt_register_callbacks-method -->

    
      <div id="method-i-evt_scan_issue" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evt_scan_issue</span><span
            class="method-args">(issue)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is invoked whenever Burp Scanner discovers a new, unique 
issue, and can be used to perform customised reporting or logging of 
detected issues.</p>

<p>IMPORTANT: This event handler is only used in Burp version 1.2.09 and 
higher.</p>

<p>Note: this method maps to the BurpExtender Java method.</p>

<p>Parameters:</p>
<ul><li>
<p>issue = an instance of the IScanIssue Java class with methods for viewing
information on the scan issue that was generated.</p>
</li></ul>
          

          
          <div class="method-source-code" id="evt_scan_issue-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 687</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evt_scan_issue</span>(<span class="ruby-identifier">issue</span>)
  <span class="ruby-constant">ScanIssueHelper</span>.<span class="ruby-identifier">implant</span>(<span class="ruby-identifier">issue</span>)
  <span class="ruby-identifier">pp</span>([<span class="ruby-value">:got_scan_issue</span>, <span class="ruby-identifier">issue</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- evt_scan_issue-source -->
          
        </div>

        

        
      </div><!-- evt_scan_issue-method -->

    
      <div id="method-i-excludeFromScope" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">excludeFromScope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Exclude the specified URL from the Suite-wide scope.</p>

<pre>* url = The URL to exclude from the Suite-wide scope.</pre>
          

          
          <div class="method-source-code" id="excludeFromScope-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 159</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">excludeFromScope</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-identifier">java</span>.<span class="ruby-identifier">net</span>.<span class="ruby-constant">URL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">url</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">excludeFromScope</span>(<span class="ruby-identifier">url</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- excludeFromScope-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-exclude_from_scope">exclude_from_scope</a>, <a href="Buby.html#method-i-exclude_scope">exclude_scope</a>
        </div>
        

        
      </div><!-- excludeFromScope-method -->

    
      <div id="method-i-exclude_from_scope" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">exclude_from_scope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-excludeFromScope">excludeFromScope</a>
        </div>
        
      </div><!-- exclude_from_scope-method -->

    
      <div id="method-i-exclude_scope" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">exclude_scope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-excludeFromScope">excludeFromScope</a>
        </div>
        
      </div><!-- exclude_scope-method -->

    
      <div id="method-i-exitSuite" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">exitSuite</span><span
            class="method-args">(prompt_user=false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Shuts down Burp programatically. If the method returns the user cancelled
the shutdown prompt.</p>
          

          
          <div class="method-source-code" id="exitSuite-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 350</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">exitSuite</span>(<span class="ruby-identifier">prompt_user</span>=<span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:exitSuite</span>, <span class="ruby-identifier">prompt_user</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- exitSuite-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-exit_suite">exit_suite</a>, <a href="Buby.html#method-i-close">close</a>
        </div>
        

        
      </div><!-- exitSuite-method -->

    
      <div id="method-i-exit_suite" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">exit_suite</span><span
            class="method-args">(prompt_user=false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-exitSuite">exitSuite</a>
        </div>
        
      </div><!-- exit_suite-method -->

    
      <div id="method-i-getBurpVersion" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getBurpVersion</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method can be used to determine the version of the loaded burp at
runtime. This is included in the Javadoc for the extension interfaces but
not the supplied interface files. @return String array containing the
product name, major version, and minor version.</p>
          

          
          <div class="method-source-code" id="getBurpVersion-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 432</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getBurpVersion</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getBurpVersion</span>)
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getBurpVersion-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-burp_version">burp_version</a>
        </div>
        

        
      </div><!-- getBurpVersion-method -->

    
      <div id="method-i-getHeaders" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getHeaders</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Parses a raw HTTP message (request or response ) and returns an associative
array containing the headers as they are structured in the ‘Headers’ tab 
in the Burp request/response viewer UI.</p>

<p>IMPORTANT: This method is only available with Burp 1.2.09 and higher.</p>

<p>msg = raw request/response (String or Java bytes[])</p>
          

          
          <div class="method-source-code" id="getHeaders-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 341</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getHeaders</span>(<span class="ruby-identifier">msg</span>)
  <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">msg</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">msg</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getHeaders</span>, <span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- getHeaders-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-headers">headers</a>, <a href="Buby.html#method-i-get_headers">get_headers</a>
        </div>
        

        
      </div><!-- getHeaders-method -->

    
      <div id="method-i-getParameters" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getParameters</span><span
            class="method-args">(req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Parses a raw HTTP request message and returns an associative array 
containing parameters as they are structured in the ‘Parameters’ tab in the
Burp request UI.</p>

<p>IMPORTANT: This method is only available with Burp 1.2.09 and higher.</p>

<p>req = raw request (String or Java bytes[])</p>
          

          
          <div class="method-source-code" id="getParameters-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 326</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getParameters</span>(<span class="ruby-identifier">req</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getParameters</span>, <span class="ruby-identifier">req</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- getParameters-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-parameters">parameters</a>, <a href="Buby.html#method-i-get_parameters">get_parameters</a>
        </div>
        

        
      </div><!-- getParameters-method -->

    
      <div id="method-i-getProxyHistory" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getProxyHistory</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns a Java array of IHttpRequestResponse objects pulled directly from 
the Burp proxy history.</p>
          

          
          <div class="method-source-code" id="getProxyHistory-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 268</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getProxyHistory</span>
  <span class="ruby-constant">HttpRequestResponseList</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getProxyHistory</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- getProxyHistory-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-proxy_history">proxy_history</a>, <a href="Buby.html#method-i-get_proxy_history">get_proxy_history</a>
        </div>
        

        
      </div><!-- getProxyHistory-method -->

    
      <div id="method-i-getScanIssues" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getScanIssues</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method returns all of the current scan issues for URLs matching the 
specified literal prefix. The prefix can be nil to match all issues.</p>

<p>IMPORTANT: This method is only available with Burp 1.2.15 and higher.</p>
          

          
          <div class="method-source-code" id="getScanIssues-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getScanIssues</span>(<span class="ruby-identifier">urlprefix</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-constant">ScanIssuesList</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getScanIssues</span>, <span class="ruby-identifier">urlprefix</span>) )
<span class="ruby-keyword">end</span></pre>
          </div><!-- getScanIssues-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-scan_issues">scan_issues</a>, <a href="Buby.html#method-i-get_scan_issues">get_scan_issues</a>
        </div>
        

        
      </div><!-- getScanIssues-method -->

    
      <div id="method-i-getSiteMap" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getSiteMap</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns a Java array of IHttpRequestResponse objects pulled directly from 
the Burp site map for all urls matching the specified literal prefix.  The
prefix can be nil to return all objects.</p>
          

          
          <div class="method-source-code" id="getSiteMap-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getSiteMap</span>(<span class="ruby-identifier">urlprefix</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-constant">HttpRequestResponseList</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:getSiteMap</span>, <span class="ruby-identifier">urlprefix</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- getSiteMap-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-site_map">site_map</a>, <a href="Buby.html#method-i-get_site_map">get_site_map</a>
        </div>
        

        
      </div><!-- getSiteMap-method -->

    
      <div id="method-i-get_headers" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">get_headers</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getHeaders">getHeaders</a>
        </div>
        
      </div><!-- get_headers-method -->

    
      <div id="method-i-get_parameters" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">get_parameters</span><span
            class="method-args">(req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getParameters">getParameters</a>
        </div>
        
      </div><!-- get_parameters-method -->

    
      <div id="method-i-get_proxy_history" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">get_proxy_history</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getProxyHistory">getProxyHistory</a>
        </div>
        
      </div><!-- get_proxy_history-method -->

    
      <div id="method-i-get_scan_issues" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">get_scan_issues</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getScanIssues">getScanIssues</a>
        </div>
        
      </div><!-- get_scan_issues-method -->

    
      <div id="method-i-get_site_map" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">get_site_map</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getSiteMap">getSiteMap</a>
        </div>
        
      </div><!-- get_site_map-method -->

    
      <div id="method-i-harvest_cookies_from_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">harvest_cookies_from_history</span><span
            class="method-args">(cookie=nil, urlrx=nil, statefile=nil) { |h| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Harvest cookies from a session’s proxy history.</p>

<p>Params:</p>

<pre>cookie    = optional: name of cookie to harvest
urlrx     = optional: regular expression to match urls against
statefile = optional: filename for a burp session file to temporarily load
            and harvest from.</pre>

<p>Takes an optional block as additional ‘select’ criteria for cookies. The
block return value of true/false will determine whether a cookie  string is
selected.</p>
          

          
          <div class="method-source-code" id="harvest_cookies_from_history-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 783</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">harvest_cookies_from_history</span>(<span class="ruby-identifier">cookie</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">urlrx</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">statefile</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">ret</span> = []
  <span class="ruby-identifier">search_proxy_history</span>(<span class="ruby-identifier">statefile</span>, <span class="ruby-identifier">urlrx</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hrr</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">heads</span>=<span class="ruby-identifier">hrr</span>.<span class="ruby-identifier">rsp_headers</span>
      <span class="ruby-identifier">ret</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">heads</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> 
        <span class="ruby-identifier">h</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-string">'set-cookie'</span> <span class="ruby-keyword">and</span> (<span class="ruby-keyword">not</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">h</span>[<span class="ruby-value">1</span>]))
      <span class="ruby-keyword">end</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-value">1</span>]}
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- harvest_cookies_from_history-source -->
          
        </div>

        

        
      </div><!-- harvest_cookies_from_history-method -->

    
      <div id="method-i-headers" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">headers</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getHeaders">getHeaders</a>
        </div>
        
      </div><!-- headers-method -->

    
      <div id="method-i-in_scope-3F" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">in_scope?</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-isInScope">isInScope</a>
        </div>
        
      </div><!-- in_scope-3F-method -->

    
      <div id="method-i-includeInScope" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">includeInScope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Include the specified URL in the Suite-wide scope.</p>

<pre>* url = The URL to exclude in the Suite-wide scope.</pre>
          

          
          <div class="method-source-code" id="includeInScope-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">includeInScope</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-identifier">java</span>.<span class="ruby-identifier">net</span>.<span class="ruby-constant">URL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">url</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">includeInScope</span>(<span class="ruby-identifier">url</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- includeInScope-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-include_in_scope">include_in_scope</a>, <a href="Buby.html#method-i-include_scope">include_scope</a>
        </div>
        

        
      </div><!-- includeInScope-method -->

    
      <div id="method-i-include_in_scope" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">include_in_scope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-includeInScope">includeInScope</a>
        </div>
        
      </div><!-- include_in_scope-method -->

    
      <div id="method-i-include_scope" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">include_scope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-includeInScope">includeInScope</a>
        </div>
        
      </div><!-- include_scope-method -->

    
      <div id="method-i-intruder" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">intruder</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToIntruder">sendToIntruder</a>
        </div>
        
      </div><!-- intruder-method -->

    
      <div id="method-i-isInScope" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">isInScope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Query whether a specified URL is within the current Suite-wide scope.</p>

<pre>* url = The URL to query</pre>

<p>Returns: true / false</p>
          

          
          <div class="method-source-code" id="isInScope-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">isInScope</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-identifier">java</span>.<span class="ruby-identifier">net</span>.<span class="ruby-constant">URL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">url</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">isInScope</span>(<span class="ruby-identifier">url</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- isInScope-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-is_in_scope">is_in_scope</a>, <a href="Buby.html#method-i-in_scope-3F">in_scope?</a>
        </div>
        

        
      </div><!-- isInScope-method -->

    
      <div id="method-i-is_in_scope" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">is_in_scope</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-isInScope">isInScope</a>
        </div>
        
      </div><!-- is_in_scope-method -->

    
      <div id="method-i-issueAlert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">issueAlert</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Display a message in the Burp Suite alerts tab.</p>

<pre>* msg =  The alert message to display.</pre>
          

          
          <div class="method-source-code" id="issueAlert-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 188</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">issueAlert</span>(<span class="ruby-identifier">msg</span>)
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">issueAlert</span>(<span class="ruby-identifier">msg</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- issueAlert-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-issue_alert">issue_alert</a>, <a href="Buby.html#method-i-alert">alert</a>
        </div>
        

        
      </div><!-- issueAlert-method -->

    
      <div id="method-i-issue_alert" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">issue_alert</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-issueAlert">issueAlert</a>
        </div>
        
      </div><!-- issue_alert-method -->

    
      <div id="method-i-loadConfig" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">loadConfig</span><span
            class="method-args">(conf)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method causes Burp to load a new configuration from the Map of
name/value Strings provided. Any settings not specified in the Map will be
restored to their default values. To selectively update only some settings
and leave the rest unchanged, you should first call <code>saveConfig</code>
to obtain Burp’s current configuration, modify the relevant items in the
Map, and then call <code>loadConfig</code> with the same Map.</p>

<p>@param config A map of name/value Strings to use as Burp’s new
configuration.</p>

<p>This method is only available with Burp 1.3.09+</p>
          

          
          <div class="method-source-code" id="loadConfig-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 410</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">loadConfig</span>(<span class="ruby-identifier">conf</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:loadConfig</span>, <span class="ruby-identifier">conf</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- loadConfig-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-load_config">load_config</a>, <a href="Buby.html#method-i-config-3D">config=</a>
        </div>
        

        
      </div><!-- loadConfig-method -->

    
      <div id="method-i-load_config" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">load_config</span><span
            class="method-args">(conf)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-loadConfig">loadConfig</a>
        </div>
        
      </div><!-- load_config-method -->

    
      <div id="method-i-makeHttpRequest" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">makeHttpRequest</span><span
            class="method-args">(host, port, https, req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Issue an arbitrary HTTP request and retrieve its response</p>

<pre>* host  = The hostname of the remote HTTP server.
* port  = The port of the remote HTTP server.
* https = Flags whether the protocol is HTTPS or HTTP.
* req   = The full HTTP request. (String or Java bytes[])</pre>

<p>Returns: The full response retrieved from the remote server.</p>
          

          
          <div class="method-source-code" id="makeHttpRequest-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 201</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">makeHttpRequest</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-constant">String</span>.<span class="ruby-identifier">from_java_bytes</span>( <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">makeHttpRequest</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>) )
<span class="ruby-keyword">end</span></pre>
          </div><!-- makeHttpRequest-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-make_http_request">make_http_request</a>, <a href="Buby.html#method-i-make_request">make_request</a>
        </div>
        

        
      </div><!-- makeHttpRequest-method -->

    
      <div id="method-i-make_http_request" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">make_http_request</span><span
            class="method-args">(host, port, https, req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-makeHttpRequest">makeHttpRequest</a>
        </div>
        
      </div><!-- make_http_request-method -->

    
      <div id="method-i-make_request" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">make_request</span><span
            class="method-args">(host, port, https, req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-makeHttpRequest">makeHttpRequest</a>
        </div>
        
      </div><!-- make_request-method -->

    
      <div id="method-i-parameters" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">parameters</span><span
            class="method-args">(req)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getParameters">getParameters</a>
        </div>
        
      </div><!-- parameters-method -->

    
      <div id="method-i-passive_scan" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">passive_scan</span><span
            class="method-args">(host, port, https, req, rsp)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-doPassiveScan">doPassiveScan</a>
        </div>
        
      </div><!-- passive_scan-method -->

    
      <div id="method-i-proxy_history" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">proxy_history</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getProxyHistory">getProxyHistory</a>
        </div>
        
      </div><!-- proxy_history-method -->

    
      <div id="method-i-proxy_interception-3D" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">proxy_interception=</span><span
            class="method-args">(enabled)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-setProxyInterceptionEnabled">setProxyInterceptionEnabled</a>
        </div>
        
      </div><!-- proxy_interception-3D-method -->

    
      <div id="method-i-proxy_interception_enabled" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">proxy_interception_enabled</span><span
            class="method-args">(enabled)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-setProxyInterceptionEnabled">setProxyInterceptionEnabled</a>
        </div>
        
      </div><!-- proxy_interception_enabled-method -->

    
      <div id="method-i-registerMenuItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">registerMenuItem</span><span
            class="method-args">(menuItemCaption, menuItemHandler)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method can be used to register a new menu item which will appear  on
the various context menus that are used throughout Burp Suite to  handle
user-driven actions.</p>

<p>@param menuItemCaption The caption to be displayed on the menu item. @param
menuItemHandler The handler to be invoked when the user clicks on the menu
item.</p>

<p>This method is only available with Burp 1.3.07 and higher.</p>
          

          
          <div class="method-source-code" id="registerMenuItem-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">registerMenuItem</span>(<span class="ruby-identifier">menuItemCaption</span>, <span class="ruby-identifier">menuItemHandler</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:registerMenuItem</span>, <span class="ruby-identifier">menuItemCaption</span>, <span class="ruby-identifier">menuItemHandler</span>)
  <span class="ruby-identifier">issueAlert</span>(<span class="ruby-node">&quot;Handler #{menuItemHandler} registered for \&quot;#{menuItemCaption}\&quot;&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- registerMenuItem-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-register_menu_item">register_menu_item</a>
        </div>
        

        
      </div><!-- registerMenuItem-method -->

    
      <div id="method-i-register_menu_item" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">register_menu_item</span><span
            class="method-args">(menuItemCaption, menuItemHandler)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-registerMenuItem">registerMenuItem</a>
        </div>
        
      </div><!-- register_menu_item-method -->

    
      <div id="method-i-repeater" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">repeater</span><span
            class="method-args">(host, port, https, req, tab=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToRepeater">sendToRepeater</a>
        </div>
        
      </div><!-- repeater-method -->

    
      <div id="method-i-restoreState" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">restoreState</span><span
            class="method-args">(filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Restores Burp session state from a previously saved state file. See also:
saveState</p>

<p>IMPORTANT: This method is only available with Burp 1.2.09 and higher.</p>
<ul><li>
<p>filename = path and filename of the file to restore from</p>
</li></ul>
          

          
          <div class="method-source-code" id="restoreState-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 302</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">restoreState</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:restoreState</span>, <span class="ruby-identifier">java</span>.<span class="ruby-identifier">io</span>.<span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filename</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- restoreState-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-restore_state">restore_state</a>
        </div>
        

        
      </div><!-- restoreState-method -->

    
      <div id="method-i-restore_state" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">restore_state</span><span
            class="method-args">(filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-restoreState">restoreState</a>
        </div>
        
      </div><!-- restore_state-method -->

    
      <div id="method-i-saveConfig" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">saveConfig</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method causes Burp to save all of its current configuration as a Map
of name/value Strings.</p>

<p>@return A Map of name/value Strings reflecting Burp’s current
configuration.</p>

<p>This method is only available with Burp 1.3.09+</p>
          

          
          <div class="method-source-code" id="saveConfig-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 392</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">saveConfig</span>
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:saveConfig</span>).<span class="ruby-identifier">to_hash</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- saveConfig-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-save_config">save_config</a>, <a href="Buby.html#method-i-config">config</a>
        </div>
        

        
      </div><!-- saveConfig-method -->

    
      <div id="method-i-saveState" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">saveState</span><span
            class="method-args">(filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Saves the current Burp session to a state file. See also restoreState.</p>

<p>IMPORTANT: This method is only available with Burp 1.2.09 and higher.</p>
<ul><li>
<p>filename = path and filename of the file to save to</p>
</li></ul>
          

          
          <div class="method-source-code" id="saveState-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 313</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">saveState</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:saveState</span>, <span class="ruby-identifier">java</span>.<span class="ruby-identifier">io</span>.<span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filename</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- saveState-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-save_state">save_state</a>
        </div>
        

        
      </div><!-- saveState-method -->

    
      <div id="method-i-save_config" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">save_config</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-saveConfig">saveConfig</a>
        </div>
        
      </div><!-- save_config-method -->

    
      <div id="method-i-save_state" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">save_state</span><span
            class="method-args">(filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-saveState">saveState</a>
        </div>
        
      </div><!-- save_state-method -->

    
      <div id="method-i-scan_issues" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">scan_issues</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getScanIssues">getScanIssues</a>
        </div>
        
      </div><!-- scan_issues-method -->

    
      <div id="method-i-search_proxy_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">search_proxy_history</span><span
            class="method-args">(statefile=nil, urlrx=nil) { |r| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Searches the proxy history for the url’s matched by the specified  regular
expression (returns them all if urlrx is nil).</p>

<p>A statefile to search in can optionally be specified or the existing state
will be used if statefile is nil.</p>

<p>This method also accepts an optional block which is passed each of the
matched history members.</p>
          

          
          <div class="method-source-code" id="search_proxy_history-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 762</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">search_proxy_history</span>(<span class="ruby-identifier">statefile</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">urlrx</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">ret</span> = []
  <span class="ruby-identifier">with_proxy_history</span>(<span class="ruby-identifier">statefile</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">not</span> <span class="ruby-identifier">urlrx</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">url</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">urlrx</span>
      <span class="ruby-identifier">ret</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span> <span class="ruby-keyword">if</span> (<span class="ruby-keyword">not</span> <span class="ruby-identifier">block_given?</span>) <span class="ruby-keyword">or</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- search_proxy_history-source -->
          
        </div>

        

        
      </div><!-- search_proxy_history-method -->

    
      <div id="method-i-sendToIntruder" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sendToIntruder</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Send an HTTP request to the Burp Intruder tool</p>

<pre>* host  = The hostname of the remote HTTP server.
* port  = The port of the remote HTTP server.
* https = Flags whether the protocol is HTTPS or HTTP.
* req   = The full HTTP request.  (String or Java bytes[])
* ip_off = A list of index pairs representing the
* positions of the insertion points that should be scanned. Each item in
* the list must be an int[2] array containing the start and end offsets
* for the insertion point. *1.4.04+* only
*</pre>
          

          
          <div class="method-source-code" id="sendToIntruder-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sendToIntruder</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">ip_off</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">getBurpVersion</span>.<span class="ruby-identifier">to_a</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;.&quot;</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-string">&quot;1.4.04&quot;</span>
    <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">sendToIntruder</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">sendToIntruder</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">ip_off</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- sendToIntruder-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-send_to_intruder">send_to_intruder</a>, <a href="Buby.html#method-i-intruder">intruder</a>
        </div>
        

        
      </div><!-- sendToIntruder-method -->

    
      <div id="method-i-sendToRepeater" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sendToRepeater</span><span
            class="method-args">(host, port, https, req, tab=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Send an HTTP request to the Burp Repeater tool.</p>

<pre>* host  = The hostname of the remote HTTP server.
* port  = The port of the remote HTTP server.
* https = Flags whether the protocol is HTTPS or HTTP.
* req   = The full HTTP request. (String or Java bytes[])
* tab   = The tab caption displayed in Repeater. (default: auto-generated)</pre>
          

          
          <div class="method-source-code" id="sendToRepeater-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 235</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sendToRepeater</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">tab</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">req</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_java_bytes</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">req</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">sendToRepeater</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">https</span>, <span class="ruby-identifier">req</span>, <span class="ruby-identifier">tab</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- sendToRepeater-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-send_to_repeater">send_to_repeater</a>, <a href="Buby.html#method-i-repeater">repeater</a>
        </div>
        

        
      </div><!-- sendToRepeater-method -->

    
      <div id="method-i-sendToSpider" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sendToSpider</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Send a seed URL to the Burp Spider tool.</p>

<pre>* url = The new seed URL to begin spidering from.</pre>
          

          
          <div class="method-source-code" id="sendToSpider-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 244</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sendToSpider</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">url</span> = <span class="ruby-identifier">java</span>.<span class="ruby-identifier">net</span>.<span class="ruby-constant">URL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">url</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">url</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-identifier">_check_cb</span>.<span class="ruby-identifier">sendToSpider</span>(<span class="ruby-identifier">url</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- sendToSpider-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-send_to_spider">send_to_spider</a>, <a href="Buby.html#method-i-spider">spider</a>
        </div>
        

        
      </div><!-- sendToSpider-method -->

    
      <div id="method-i-send_to_intruder" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">send_to_intruder</span><span
            class="method-args">(host, port, https, req, ip_off)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToIntruder">sendToIntruder</a>
        </div>
        
      </div><!-- send_to_intruder-method -->

    
      <div id="method-i-send_to_repeater" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">send_to_repeater</span><span
            class="method-args">(host, port, https, req, tab=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToRepeater">sendToRepeater</a>
        </div>
        
      </div><!-- send_to_repeater-method -->

    
      <div id="method-i-send_to_spider" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">send_to_spider</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToSpider">sendToSpider</a>
        </div>
        
      </div><!-- send_to_spider-method -->

    
      <div id="method-i-setProxyInterceptionEnabled" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">setProxyInterceptionEnabled</span><span
            class="method-args">(enabled)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method sets the interception mode for Burp Proxy.</p>

<p>@param enabled Indicates whether interception of proxy messages should  be
enabled.</p>
          

          
          <div class="method-source-code" id="setProxyInterceptionEnabled-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 423</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">setProxyInterceptionEnabled</span>(<span class="ruby-identifier">enabled</span>)
  <span class="ruby-identifier">_check_and_callback</span>(<span class="ruby-value">:setProxyInterceptionEnabled</span>, <span class="ruby-identifier">enabled</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- setProxyInterceptionEnabled-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Buby.html#method-i-proxy_interception_enabled">proxy_interception_enabled</a>, <a href="Buby.html#method-i-proxy_interception-3D">proxy_interception=</a>
        </div>
        

        
      </div><!-- setProxyInterceptionEnabled-method -->

    
      <div id="method-i-site_map" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">site_map</span><span
            class="method-args">(urlprefix=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-getSiteMap">getSiteMap</a>
        </div>
        
      </div><!-- site_map-method -->

    
      <div id="method-i-spider" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">spider</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Buby.html#method-i-sendToSpider">sendToSpider</a>
        </div>
        
      </div><!-- spider-method -->

    
      <div id="method-i-start_burp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start_burp</span><span
            class="method-args">(args=[])</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Prepares the java BurpExtender implementation with a reference to self as
the module handler and launches burp suite.</p>
          

          
          <div class="method-source-code" id="start_burp-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 799</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">start_burp</span>(<span class="ruby-identifier">args</span>=[])
  <span class="ruby-identifier">activate!</span>()
  <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-constant">Burp</span><span class="ruby-operator">::</span><span class="ruby-constant">StartBurp</span>.<span class="ruby-identifier">main</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">to_java</span>(<span class="ruby-value">:string</span>))
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- start_burp-source -->
          
        </div>

        

        
      </div><!-- start_burp-method -->

    
      <div id="method-i-with_proxy_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_proxy_history</span><span
            class="method-args">(statefile=nil) { |h| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This is a convenience wrapper which can load a given burp state file and 
lets its caller to perform actions inside of a block on the proxy history 
contained in the loaded session.</p>

<p>If a statefile argument isn’t specified current burp session state is used.</p>

<p>Yields each entry in the proxy history to a block.</p>
          

          
          <div class="method-source-code" id="with_proxy_history-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 721</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_proxy_history</span>(<span class="ruby-identifier">statefile</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">with_statefile</span>(<span class="ruby-identifier">statefile</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">this</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">this</span>.<span class="ruby-identifier">proxy_history</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">h</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- with_proxy_history-source -->
          
        </div>

        

        
      </div><!-- with_proxy_history-method -->

    
      <div id="method-i-with_site_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_site_map</span><span
            class="method-args">(urlprefix=nil, statefile=nil) { |h| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This is a convenience wrapper which can load a given burp state file and 
lets its caller to perform actions inside of a block on the site map 
contained in the loaded session.</p>

<p>If a statefile argument isn’t specified current burp session state is used.</p>

<p>Yields each entry in the site map to a block.</p>
          

          
          <div class="method-source-code" id="with_site_map-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 708</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_site_map</span>(<span class="ruby-identifier">urlprefix</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">statefile</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">with_statefile</span>(<span class="ruby-identifier">statefile</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">this</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">this</span>.<span class="ruby-identifier">site_map</span>(<span class="ruby-identifier">urlprefix</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">h</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- with_site_map-source -->
          
        </div>

        

        
      </div><!-- with_site_map-method -->

    
      <div id="method-i-with_statefile" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_statefile</span><span
            class="method-args">(statefile=nil) { |self| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This is a convenience wrapper which loads a given burp statefile and lets
its caller perform actions via burp while its loaded on it inside of a 
block. The old state is restored after the block completes.</p>

<p>It can safely be run with a nil statefile argument in which the  current
burp session state is used.</p>
          

          
          <div class="method-source-code" id="with_statefile-source">
            <pre><span class="ruby-comment"># File lib/buby.rb, line 733</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_statefile</span>(<span class="ruby-identifier">statefile</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">statefile</span>
    <span class="ruby-comment"># save current state:</span>
    <span class="ruby-identifier">old_state</span>=<span class="ruby-node">&quot;.#{$$}.#{Time.now.to_i}.state.bak&quot;</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">alert</span> <span class="ruby-node">&quot;Saving current state to temp statefile: #{old_state}&quot;</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">save_state</span>(<span class="ruby-identifier">old_state</span>)
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">alert</span> <span class="ruby-node">&quot;Restoring state: #{statefile}&quot;</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">restore_state</span>(<span class="ruby-identifier">statefile</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">statefile</span>
    <span class="ruby-comment"># restore original state</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">alert</span> <span class="ruby-node">&quot;Restoring temp statefile: #{old_state}&quot;</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">restore_state</span> <span class="ruby-identifier">old_state</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">alert</span> <span class="ruby-node">&quot;Deleting temp state file: #{old_state}&quot;</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span> <span class="ruby-identifier">old_state</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- with_statefile-source -->
          
        </div>

        

        
      </div><!-- with_statefile-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

